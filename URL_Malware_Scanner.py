import requests
import time

# Replace this with your actual VirusTotal API key
API_KEY = 'W8j9ZpQM0T5yE3hNV2XLsBf6uGKAod1Q'

def scan_url(url):
    headers = {
        "x-apikey": API_KEY
    }

    # 1. Submit the URL to be scanned
    print(f"\n🔍 Submitting URL for scan: {url}")
    scan_url = "https://www.virustotal.com/api/v3/urls"
    data = {"url": url}
    response = requests.post(scan_url, headers=headers, data=data)

    if response.status_code != 200:
        print("❌ Failed to submit URL for scanning.")
        return

    analysis_id = response.json()['data']['id']

    # 2. Wait and retrieve scan result
    print("⏳ Waiting for scan results...")
    time.sleep(10)  # wait to let VirusTotal complete scan

    result_url = f"https://www.virustotal.com/api/v3/analyses/{analysis_id}"
    result = requests.get(result_url, headers=headers).json()

    stats = result['data']['attributes']['stats']
    malicious = stats['malicious']
    suspicious = stats['suspicious']
    harmless = stats['harmless']

    print("\n✅ Scan Results:")
    print(f" - Harmless reports: {harmless}")
    print(f" - Suspicious reports: {suspicious}")
    print(f" - Malicious reports: {malicious}")

    if malicious > 0 or suspicious > 0:
        print("⚠ Warning: This URL may be unsafe!")
    else:
        print("✅ The URL appears to be safe.")

# ---- Main Program ----
if _name_ == "_main_":
    print("=== 🛡 URL Malware Scanner ===")
    user_url = input("Enter the URL to scan: ").strip()
    scan_url(user_url)
